---
$schema: http://json-schema.org/draft-07/schema#
title: WOUDC Data Registry ExtCSV tables schema
description: Validation schema for WOUDC data registry table definition files.
type: object

definitions:
  table_def:
    type: object
    properties:
      rows:
        type:
          - integer
          - string
      occurrences:
        type:
          - integer
          - string
      required_fields:
        type: array
        minItems: 1
        items:
          type: string
      optional_fields:
        type: array
        minItems: 1
        items:
          type: string
    additionalProperties: false

  dataset_def:
    type: object
    properties:
      data_table:
        type: string
    patternProperties:
      ^[A-Z][A-Z0-9_]*$:
        $ref: "#/definitions/table_def"


properties:
  Common:
    description: A series of definitions for metadata tables that are required in all Extended CSV files.
    type: object
    patternProperties:
      ^[A-Z0-9_]+$:
        $ref: "#/definitions/table_def"
  Datasets:
    type: object
    patternProperties:
      ^[a-zA-Z0-9_]+$:
        type: object
        patternProperties:
          ^\d+\.\d$:
            anyOf:
              - $ref: "#/definitions/dataset_def"
              - type: object
                patternProperties:
                  ^\d+$:
                    $ref: "#/definitions/dataset_def"
                additionalProperties: false
...